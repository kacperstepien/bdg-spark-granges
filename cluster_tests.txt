1g x 1m
==========

cores| genApp[s] | BDG-JointWithRowBroadcast[s] | BDG-TwoPhaseJoin[s]
====================================================================
10   |  166.5      |    27.8                      |   24.4
20   |  166.5      |    16.7                      |   24.4
60   |  151.2      |     9.9                      |   15.2



scala> time(spark.sqlContext.sql(sqlQuery).show)
18/02/07 18:40:18 WARN IntervalTree.IntervalTreeJoinOptimImpl$:
Broadcast structure size is ~ 14062 kb
spark.biodatageeks.rangejoin.maxBroadcastSize is set to 102400 kb"
Using JointWithRowBroadcast join method

+--------+
|count(1)|
+--------+
| 1000000|
+--------+

time: 9.885696826 seconds

scala> time(spark.sqlContext.sql(sqlQuery).show)
18/02/07 18:31:55 WARN IntervalTree.IntervalTreeJoinOptimImpl$:
Broadcast structure size is ~ 14062 kb
spark.biodatageeks.rangejoin.maxBroadcastSize is set to 10240 kb"
Using TwoPhaseJoin join method

+--------+
|count(1)|
+--------+
| 1000000|
+--------+

time: 15.231901199 seconds

scala> spark.experimental.extraStrategies = new IntervalTreeJoinStrategy(spark) :: Nil
spark.experimental.extraStrategies: Seq[org.apache.spark.sql.Strategy] = List(org.biodatageeks.rangejoins.genApp.IntervalTreeJoinStrategy@2cbb97f7)

scala> time(spark.sqlContext.sql(sqlQuery).show)
+--------+
|count(1)|
+--------+
| 1000000|
+--------+

time: 151.846578371 seconds
